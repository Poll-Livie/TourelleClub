C51 COMPILER V9.60.0.0   INITDEVICE                                                        11/10/2022 23:22:22 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE INITDEVICE
OBJECT MODULE PLACED IN .\src/InitDevice.OBJ
COMPILER INVOKED BY: Z:\Applications\Simplicity Studio.app\Contents\Eclipse\developer\toolchains\keil_8051\9.60\BIN\C51.
                    -exe /Users/paul_leveque/Documents/10_Projets/EFM8BB1_PCA_Lib_8bitCenterPWM/src/InitDevice.c OMF2 SMALL DEBUG OBJECTEXTEN
                    -D ROM(LARGE) WARNINGLEVEL(2) FLOATFUZZY(3) OPTIMIZE(8,SPEED) DEFINE(DEBUG=1) INTVECTOR(0X0000) INTPROMOTE INCDIR(/Users/
                    -paul_leveque/Documents/10_Projets/EFM8BB1_PCA_Lib_8bitCenterPWM/inc;/Users/paul_leveque/Documents/10_Projets/EFM8BB1_PCA
                    -_Lib_8bitCenterPWM/inc/config;/Users/paul_leveque/Documents/10_Projets/EFM8BB1_PCA_Lib_8bitCenterPWM/drivers;/Applicatio
                    -ns/Simplicity Studio.app/Contents/Eclipse/developer/sdks/8051/v4.2.4//Device/EFM8BB1/peripheral_driver/inc;/Applications
                    -/Simplicity Studio.app/Contents/Eclipse/developer/sdks/8051/v4.2.4//Lib/efm8_assert;/Applications/Simplicity Studio.app/
                    -Contents/Eclipse/developer/sdks/8051/v4.2.4//kits/common/bsp;/Applications/Simplicity Studio.app/Contents/Eclipse/develo
                    -per/sdks/8051/v4.2.4//kits/EFM8BB1_LCK/config;/Applications/Simplicity Studio.app/Contents/Eclipse/developer/sdks/8051/v
                    -4.2.4//Device/shared/si8051Base;/Applications/Simplicity Studio.app/Contents/Eclipse/developer/sdks/8051/v4.2.4//Device/
                    -EFM8BB1/inc) PRINT(.\src/InitDevice.lst) COND PAGEWIDTH(120) PAGELENGTH(65) OBJECT(.\src/InitDevice.OBJ)

line level    source

   1          //=========================================================
   2          // src/InitDevice.c: generated by Hardware Configurator
   3          //
   4          // This file will be regenerated when saving a document.
   5          // leave the sections inside the "$[...]" comment tags alone
   6          // or they will be overwritten!
   7          //=========================================================
   8          
   9          // USER INCLUDES
  10          #include <SI_EFM8BB1_Register_Enums.h>
  11          #include "InitDevice.h"
  12          
  13          // USER PROTOTYPES
  14          // USER FUNCTIONS
  15          
  16          // $[Library Includes]
  17          // [Library Includes]$
  18          
  19          //==============================================================================
  20          // enter_DefaultMode_from_RESET
  21          //==============================================================================
  22          extern void
  23          enter_DefaultMode_from_RESET (void)
  24          {
  25   1        // $[Config Calls]
  26   1        WDT_0_enter_DefaultMode_from_RESET ();
  27   1        PORTS_0_enter_DefaultMode_from_RESET ();
  28   1        PORTS_1_enter_DefaultMode_from_RESET ();
  29   1        PBCFG_0_enter_DefaultMode_from_RESET ();
  30   1        CLOCK_0_enter_DefaultMode_from_RESET ();
  31   1        PCA_0_enter_DefaultMode_from_RESET ();
  32   1        PCACH_0_enter_DefaultMode_from_RESET ();
  33   1        PCACH_1_enter_DefaultMode_from_RESET ();
  34   1        SPI_0_enter_DefaultMode_from_RESET ();
  35   1        // [Config Calls]$
  36   1      
  37   1      }
  38          
  39          //================================================================================
  40          // WDT_0_enter_DefaultMode_from_RESET
  41          //================================================================================
  42          extern void
  43          WDT_0_enter_DefaultMode_from_RESET (void)
  44          {
  45   1        // $[Watchdog Timer Init Variable Declarations]
  46   1        uint32_t i;
C51 COMPILER V9.60.0.0   INITDEVICE                                                        11/10/2022 23:22:22 PAGE 2   

  47   1        bool ea;
  48   1        // [Watchdog Timer Init Variable Declarations]$
  49   1      
  50   1        // $[WDTCN - Watchdog Timer Control]
  51   1        // Deprecated
  52   1        // [WDTCN - Watchdog Timer Control]$
  53   1      
  54   1        // $[WDTCN_2 - Watchdog Timer Control]
  55   1      
  56   1        // Feed WDT timer before disabling (Erratum WDT_E102)
  57   1        WDTCN = 0xA5;
  58   1      
  59   1        // Add 2 LFO cycle delay before disabling WDT (Erratum WDT_E102)
  60   1        for (i = 0; i < (2 * 3062500UL) / (10000 * 3); i++)
  61   1          {
  62   2            NOP ();
  63   2          }
  64   1      
  65   1        // Disable WDT
  66   1        ea = IE_EA;
  67   1        IE_EA = 0;
  68   1        WDTCN = 0xDE;
  69   1        WDTCN = 0xAD;
  70   1        IE_EA = ea;
  71   1      
  72   1        // [WDTCN_2 - Watchdog Timer Control]$
  73   1      
  74   1      }
  75          
  76          //================================================================================
  77          // PORTS_0_enter_DefaultMode_from_RESET
  78          //================================================================================
  79          extern void
  80          PORTS_0_enter_DefaultMode_from_RESET (void)
  81          {
  82   1        // $[P0 - Port 0 Pin Latch]
  83   1        // [P0 - Port 0 Pin Latch]$
  84   1      
  85   1        // $[P0MDOUT - Port 0 Output Mode]
  86   1        /***********************************************************************
  87   1         - P0.0 output is open-drain
  88   1         - P0.1 output is push-pull
  89   1         - P0.2 output is open-drain
  90   1         - P0.3 output is open-drain
  91   1         - P0.4 output is open-drain
  92   1         - P0.5 output is open-drain
  93   1         - P0.6 output is open-drain
  94   1         - P0.7 output is open-drain
  95   1         ***********************************************************************/
  96   1        P0MDOUT = P0MDOUT_B0__OPEN_DRAIN | P0MDOUT_B1__PUSH_PULL
  97   1            | P0MDOUT_B2__OPEN_DRAIN | P0MDOUT_B3__OPEN_DRAIN | P0MDOUT_B4__OPEN_DRAIN
  98   1            | P0MDOUT_B5__OPEN_DRAIN | P0MDOUT_B6__OPEN_DRAIN
  99   1            | P0MDOUT_B7__OPEN_DRAIN;
 100   1        // [P0MDOUT - Port 0 Output Mode]$
 101   1      
 102   1        // $[P0MDIN - Port 0 Input Mode]
 103   1        // [P0MDIN - Port 0 Input Mode]$
 104   1      
 105   1        // $[P0SKIP - Port 0 Skip]
 106   1        /***********************************************************************
 107   1         - P0.0 pin is not skipped by the crossbar
 108   1         - P0.1 pin is not skipped by the crossbar
 109   1         - P0.2 pin is not skipped by the crossbar
C51 COMPILER V9.60.0.0   INITDEVICE                                                        11/10/2022 23:22:22 PAGE 3   

 110   1         - P0.3 pin is skipped by the crossbar
 111   1         - P0.4 pin is skipped by the crossbar
 112   1         - P0.5 pin is skipped by the crossbar
 113   1         - P0.6 pin is skipped by the crossbar
 114   1         - P0.7 pin is skipped by the crossbar
 115   1         ***********************************************************************/
 116   1        P0SKIP = P0SKIP_B0__NOT_SKIPPED | P0SKIP_B1__NOT_SKIPPED
 117   1            | P0SKIP_B2__NOT_SKIPPED | P0SKIP_B3__SKIPPED | P0SKIP_B4__SKIPPED
 118   1            | P0SKIP_B5__SKIPPED | P0SKIP_B6__SKIPPED | P0SKIP_B7__SKIPPED;
 119   1        // [P0SKIP - Port 0 Skip]$
 120   1      
 121   1        // $[P0MASK - Port 0 Mask]
 122   1        // [P0MASK - Port 0 Mask]$
 123   1      
 124   1        // $[P0MAT - Port 0 Match]
 125   1        // [P0MAT - Port 0 Match]$
 126   1      
 127   1      }
 128          
 129          //================================================================================
 130          // PORTS_1_enter_DefaultMode_from_RESET
 131          //================================================================================
 132          extern void
 133          PORTS_1_enter_DefaultMode_from_RESET (void)
 134          {
 135   1        // $[P1 - Port 1 Pin Latch]
 136   1        // [P1 - Port 1 Pin Latch]$
 137   1      
 138   1        // $[P1MDOUT - Port 1 Output Mode]
 139   1        /***********************************************************************
 140   1         - P1.0 output is open-drain
 141   1         - P1.1 output is open-drain
 142   1         - P1.2 output is open-drain
 143   1         - P1.3 output is open-drain
 144   1         - P1.4 output is push-pull
 145   1         - P1.5 output is push-pull
 146   1         - P1.6 output is open-drain
 147   1         - P1.7 output is open-drain
 148   1         ***********************************************************************/
 149   1        P1MDOUT = P1MDOUT_B0__OPEN_DRAIN | P1MDOUT_B1__OPEN_DRAIN
 150   1            | P1MDOUT_B2__OPEN_DRAIN | P1MDOUT_B3__OPEN_DRAIN | P1MDOUT_B4__PUSH_PULL
 151   1            | P1MDOUT_B5__PUSH_PULL | P1MDOUT_B6__OPEN_DRAIN | P1MDOUT_B7__OPEN_DRAIN;
 152   1        // [P1MDOUT - Port 1 Output Mode]$
 153   1      
 154   1        // $[P1MDIN - Port 1 Input Mode]
 155   1        // [P1MDIN - Port 1 Input Mode]$
 156   1      
 157   1        // $[P1SKIP - Port 1 Skip]
 158   1        /***********************************************************************
 159   1         - P1.0 pin is skipped by the crossbar
 160   1         - P1.1 pin is skipped by the crossbar
 161   1         - P1.2 pin is skipped by the crossbar
 162   1         - P1.3 pin is skipped by the crossbar
 163   1         - P1.4 pin is not skipped by the crossbar
 164   1         - P1.5 pin is not skipped by the crossbar
 165   1         - P1.6 pin is not skipped by the crossbar
 166   1         - P1.7 pin is not skipped by the crossbar
 167   1         ***********************************************************************/
 168   1        P1SKIP = P1SKIP_B0__SKIPPED | P1SKIP_B1__SKIPPED | P1SKIP_B2__SKIPPED
 169   1            | P1SKIP_B3__SKIPPED | P1SKIP_B4__NOT_SKIPPED | P1SKIP_B5__NOT_SKIPPED
 170   1            | P1SKIP_B6__NOT_SKIPPED | P1SKIP_B7__NOT_SKIPPED;
 171   1        // [P1SKIP - Port 1 Skip]$
 172   1      
C51 COMPILER V9.60.0.0   INITDEVICE                                                        11/10/2022 23:22:22 PAGE 4   

 173   1        // $[P1MASK - Port 1 Mask]
 174   1        // [P1MASK - Port 1 Mask]$
 175   1      
 176   1        // $[P1MAT - Port 1 Match]
 177   1        // [P1MAT - Port 1 Match]$
 178   1      
 179   1      }
 180          
 181          //================================================================================
 182          // PBCFG_0_enter_DefaultMode_from_RESET
 183          //================================================================================
 184          extern void
 185          PBCFG_0_enter_DefaultMode_from_RESET (void)
 186          {
 187   1        // $[XBR2 - Port I/O Crossbar 2]
 188   1        /***********************************************************************
 189   1         - Weak Pullups enabled 
 190   1         - Crossbar enabled
 191   1         ***********************************************************************/
 192   1        XBR2 = XBR2_WEAKPUD__PULL_UPS_ENABLED | XBR2_XBARE__ENABLED;
 193   1        // [XBR2 - Port I/O Crossbar 2]$
 194   1      
 195   1        // $[PRTDRV - Port Drive Strength]
 196   1        // [PRTDRV - Port Drive Strength]$
 197   1      
 198   1        // $[XBR0 - Port I/O Crossbar 0]
 199   1        /***********************************************************************
 200   1         - UART I/O unavailable at Port pin
 201   1         - SPI I/O routed to Port pins
 202   1         - SMBus 0 I/O unavailable at Port pins
 203   1         - CP0 unavailable at Port pin
 204   1         - Asynchronous CP0 unavailable at Port pin
 205   1         - CP1 unavailable at Port pin
 206   1         - Asynchronous CP1 unavailable at Port pin
 207   1         - SYSCLK unavailable at Port pin
 208   1         ***********************************************************************/
 209   1        XBR0 = XBR0_URT0E__DISABLED | XBR0_SPI0E__ENABLED | XBR0_SMB0E__DISABLED
 210   1            | XBR0_CP0E__DISABLED | XBR0_CP0AE__DISABLED | XBR0_CP1E__DISABLED
 211   1            | XBR0_CP1AE__DISABLED | XBR0_SYSCKE__DISABLED;
 212   1        // [XBR0 - Port I/O Crossbar 0]$
 213   1      
 214   1        // $[XBR1 - Port I/O Crossbar 1]
 215   1        /***********************************************************************
 216   1         - CEX0, CEX1 routed to Port pins
 217   1         - ECI unavailable at Port pin
 218   1         - T0 unavailable at Port pin
 219   1         - T1 unavailable at Port pin
 220   1         - T2 unavailable at Port pin
 221   1         ***********************************************************************/
 222   1        XBR1 = XBR1_PCA0ME__CEX0_CEX1 | XBR1_ECIE__DISABLED | XBR1_T0E__DISABLED
 223   1            | XBR1_T1E__DISABLED | XBR1_T2E__DISABLED;
 224   1        // [XBR1 - Port I/O Crossbar 1]$
 225   1      
 226   1      }
 227          
 228          //================================================================================
 229          // CLOCK_0_enter_DefaultMode_from_RESET
 230          //================================================================================
 231          extern void
 232          CLOCK_0_enter_DefaultMode_from_RESET (void)
 233          {
 234   1        // $[CLKSEL - Clock Select]
 235   1        /***********************************************************************
C51 COMPILER V9.60.0.0   INITDEVICE                                                        11/10/2022 23:22:22 PAGE 5   

 236   1         - Clock derived from the Internal High-Frequency Oscillator
 237   1         - SYSCLK is equal to selected clock source divided by 1
 238   1         ***********************************************************************/
 239   1        CLKSEL = CLKSEL_CLKSL__HFOSC | CLKSEL_CLKDIV__SYSCLK_DIV_1;
 240   1        // [CLKSEL - Clock Select]$
 241   1      
 242   1      }
 243          
 244          //================================================================================
 245          // PCA_0_enter_DefaultMode_from_RESET
 246          //================================================================================
 247          extern void
 248          PCA_0_enter_DefaultMode_from_RESET (void)
 249          {
 250   1        // $[PCA Off]
 251   1        PCA0CN0_CR = PCA0CN0_CR__STOP;
 252   1        // [PCA Off]$
 253   1      
 254   1        // $[PCA0MD - PCA Mode]
 255   1        /***********************************************************************
 256   1         - PCA continues to function normally while the system controller is in
 257   1         Idle Mode
 258   1         - Disable the CF interrupt
 259   1         - System clock
 260   1         ***********************************************************************/
 261   1        PCA0MD = PCA0MD_CIDL__NORMAL | PCA0MD_ECF__OVF_INT_DISABLED
 262   1            | PCA0MD_CPS__SYSCLK;
 263   1        // [PCA0MD - PCA Mode]$
 264   1      
 265   1        // $[PCA0CENT - PCA Center Alignment Enable]
 266   1        /***********************************************************************
 267   1         - Center-aligned
 268   1         - Center-aligned
 269   1         - Edge-aligned
 270   1         ***********************************************************************/
 271   1        PCA0CENT = PCA0CENT_CEX0CEN__CENTER | PCA0CENT_CEX1CEN__CENTER
 272   1            | PCA0CENT_CEX2CEN__EDGE;
 273   1        // [PCA0CENT - PCA Center Alignment Enable]$
 274   1      
 275   1        // $[PCA0CLR - PCA Comparator Clear Control]
 276   1        // [PCA0CLR - PCA Comparator Clear Control]$
 277   1      
 278   1        // $[PCA0L - PCA Counter/Timer Low Byte]
 279   1        // [PCA0L - PCA Counter/Timer Low Byte]$
 280   1      
 281   1        // $[PCA0H - PCA Counter/Timer High Byte]
 282   1        // [PCA0H - PCA Counter/Timer High Byte]$
 283   1      
 284   1        // $[PCA0POL - PCA Output Polarity]
 285   1        // [PCA0POL - PCA Output Polarity]$
 286   1      
 287   1        // $[PCA0PWM - PCA PWM Configuration]
 288   1        // [PCA0PWM - PCA PWM Configuration]$
 289   1      
 290   1        // $[PCA On]
 291   1        PCA0CN0_CR = PCA0CN0_CR__RUN;
 292   1        // [PCA On]$
 293   1      
 294   1      }
 295          
 296          //================================================================================
 297          // PCACH_0_enter_DefaultMode_from_RESET
 298          //================================================================================
C51 COMPILER V9.60.0.0   INITDEVICE                                                        11/10/2022 23:22:22 PAGE 6   

 299          extern void
 300          PCACH_0_enter_DefaultMode_from_RESET (void)
 301          {
 302   1        // $[PCA0 Settings Save]
 303   1        // Select Capture/Compare register)
 304   1        PCA0PWM &= ~PCA0PWM_ARSEL__BMASK;
 305   1        // [PCA0 Settings Save]$
 306   1      
 307   1        // $[PCA0CPM0 - PCA Channel 0 Capture/Compare Mode]
 308   1        /***********************************************************************
 309   1         - Disable negative edge capture
 310   1         - Disable CCF0 interrupts
 311   1         - Disable match function
 312   1         - 8 to 11-bit PWM selected
 313   1         - Disable positive edge capture
 314   1         - Enable comparator function
 315   1         - Enable PWM function
 316   1         - Disable toggle function
 317   1         ***********************************************************************/
 318   1        PCA0CPM0 = PCA0CPM0_CAPN__DISABLED | PCA0CPM0_ECCF__DISABLED
 319   1            | PCA0CPM0_MAT__DISABLED | PCA0CPM0_PWM16__8_BIT | PCA0CPM0_CAPP__DISABLED
 320   1            | PCA0CPM0_ECOM__ENABLED | PCA0CPM0_PWM__ENABLED | PCA0CPM0_TOG__DISABLED;
 321   1        // [PCA0CPM0 - PCA Channel 0 Capture/Compare Mode]$
 322   1      
 323   1        // $[PCA0CPL0 - PCA Channel 0 Capture Module Low Byte]
 324   1        /***********************************************************************
 325   1         - PCA Channel 0 Capture Module Low Byte = 0x80
 326   1         ***********************************************************************/
 327   1        PCA0CPL0 = (0x80 << PCA0CPL0_PCA0CPL0__SHIFT);
 328   1        // [PCA0CPL0 - PCA Channel 0 Capture Module Low Byte]$
 329   1      
 330   1        // $[PCA0CPH0 - PCA Channel 0 Capture Module High Byte]
 331   1        /***********************************************************************
 332   1         - PCA Channel 0 Capture Module High Byte = 0x80
 333   1         ***********************************************************************/
 334   1        PCA0CPH0 = (0x80 << PCA0CPH0_PCA0CPH0__SHIFT);
 335   1        // [PCA0CPH0 - PCA Channel 0 Capture Module High Byte]$
 336   1      
 337   1        // $[Auto-reload]
 338   1        // [Auto-reload]$
 339   1      
 340   1        // $[PCA0 Settings Restore]
 341   1        // [PCA0 Settings Restore]$
 342   1      
 343   1      }
 344          
 345          //================================================================================
 346          // PCACH_1_enter_DefaultMode_from_RESET
 347          //================================================================================
 348          extern void
 349          PCACH_1_enter_DefaultMode_from_RESET (void)
 350          {
 351   1        // $[PCA0 Settings Save]
 352   1        // Select Capture/Compare register)
 353   1        PCA0PWM &= ~PCA0PWM_ARSEL__BMASK;
 354   1        // [PCA0 Settings Save]$
 355   1      
 356   1        // $[PCA0CPM1 - PCA Channel 1 Capture/Compare Mode]
 357   1        /***********************************************************************
 358   1         - Disable negative edge capture
 359   1         - Disable CCF1 interrupts
 360   1         - Disable match function
 361   1         - 8 to 11-bit PWM selected
C51 COMPILER V9.60.0.0   INITDEVICE                                                        11/10/2022 23:22:22 PAGE 7   

 362   1         - Disable positive edge capture
 363   1         - Enable comparator function
 364   1         - Enable PWM function
 365   1         - Disable toggle function
 366   1         ***********************************************************************/
 367   1        PCA0CPM1 = PCA0CPM1_CAPN__DISABLED | PCA0CPM1_ECCF__DISABLED
 368   1            | PCA0CPM1_MAT__DISABLED | PCA0CPM1_PWM16__8_BIT | PCA0CPM1_CAPP__DISABLED
 369   1            | PCA0CPM1_ECOM__ENABLED | PCA0CPM1_PWM__ENABLED | PCA0CPM1_TOG__DISABLED;
 370   1        // [PCA0CPM1 - PCA Channel 1 Capture/Compare Mode]$
 371   1      
 372   1        // $[PCA0CPL1 - PCA Channel 1 Capture Module Low Byte]
 373   1        /***********************************************************************
 374   1         - PCA Channel 1 Capture Module Low Byte = 0xFF
 375   1         ***********************************************************************/
 376   1        PCA0CPL1 = (0xFF << PCA0CPL1_PCA0CPL1__SHIFT);
 377   1        // [PCA0CPL1 - PCA Channel 1 Capture Module Low Byte]$
 378   1      
 379   1        // $[PCA0CPH1 - PCA Channel 1 Capture Module High Byte]
 380   1        /***********************************************************************
 381   1         - PCA Channel 1 Capture Module High Byte = 0xFF
 382   1         ***********************************************************************/
 383   1        PCA0CPH1 = (0xFF << PCA0CPH1_PCA0CPH1__SHIFT);
 384   1        // [PCA0CPH1 - PCA Channel 1 Capture Module High Byte]$
 385   1      
 386   1        // $[Auto-reload]
 387   1        // [Auto-reload]$
 388   1      
 389   1        // $[PCA0 Settings Restore]
 390   1        // [PCA0 Settings Restore]$
 391   1      
 392   1      }
 393          
 394          extern void
 395          SPI_0_enter_DefaultMode_from_RESET (void)
 396          {
 397   1        // $[SPI0CKR - SPI0 Clock Rate]
 398   1        /***********************************************************************
 399   1         - SPI0 Clock Rate = 0x07
 400   1         ***********************************************************************/
 401   1        SPI0CKR = (0x07 << SPI0CKR_SPI0CKR__SHIFT);
 402   1        // [SPI0CKR - SPI0 Clock Rate]$
 403   1      
 404   1        // $[SPI0CFG - SPI0 Configuration]
 405   1        // [SPI0CFG - SPI0 Configuration]$
 406   1      
 407   1        // $[SPI0CN0 - SPI0 Control]
 408   1        /***********************************************************************
 409   1         - 3-Wire Slave or 3-Wire Master Mode
 410   1         ***********************************************************************/
 411   1        SPI0CN0 &= ~SPI0CN0_NSSMD__FMASK;
 412   1        // [SPI0CN0 - SPI0 Control]$
 413   1      
 414   1      }
 415          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    172    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       4
   IDATA SIZE       =   ----    ----
C51 COMPILER V9.60.0.0   INITDEVICE                                                        11/10/2022 23:22:22 PAGE 8   

   BIT SIZE         =   ----       1
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
